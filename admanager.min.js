var googletag=googletag||{};googletag.cmd=googletag.cmd||[];var pbjs=pbjs||{};pbjs.que=pbjs.que||[];var section=getSection(),targeting=getTargeting(section),gotAds=!1;function pickAdFlow(){var e=hasCmp();e?initCmpAds(e):hasLegacyConsent()&&loadAds(e)}function initCmpAds(e){"faktor"==e&&window.__cmp("addEventListener","cmpReady",function(){getDfpConsent(e)?loadAds(e):loadAdsOnConsentEvent(e)}),"cookiebot"==e&&window.addEventListener("CookiebotOnLoad",function(){loadAds(e)},!1)}function loadAds(e){loadDfp(function(){loadPrebidJs(function(){var t=getAdslots();loadPrebid(t,section,e),defineAdslots(t,targeting,e),renderAds(t)})})}function loadAdserverOnConsentEvent(e){var t="https:"==document.location.protocol,n=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js",o=(t?"https:":"http:")+"//crs-media-cdn.nl/prebid.js";jQuery.getScript(n,function(){jQuery.getScript(o);var t=getAdslots();loadPrebid(t,section,e),defineAdslots(t,targeting,e),renderAds(t)})}function loadAdsOnConsentEvent(e){gotAds||e&&"faktor"==e&&window.__cmp("addEventListener","consentChanged",function(){getDfpConsent(e)&&loadAdserverOnConsentEvent(e)})}function setGoogleTag(e){googletag.cmd.push(function(){googletag.pubads().disableInitialLoad()}),getGoogleConsent(e)||googletag.cmd.push(function(){googletag.pubads().disableInitialLoad(),googletag.pubads().setRequestNonPersonalizedAds(1)})}function getPbjsConfig(e){if(pbjsConfig={enableSendAllBids:!0,pubcid:{enable:!1,expInterval:105120},priceGranularity:"dense",consentManagement:{cmpApi:"iab",allowAuctionWithoutConsent:!1},currency:{adServerCurrency:"EUR",conversionRateFile:"https://currency.prebid.org/latest.json",bidderCurrencyDefault:{improvedigital:"EUR",criteo:"EUR",rubicon:"USD",ix:"EUR",appnexus:"EUR"}}},e&&"faktor"==e){for(var t=!0,n=[32,91,52,10],o=0;o<n.length;o++)getIabVendorConsent(n[o],[1,2])||(t=!1);t&&(pbjsConfig.pubcid.enable=!0)}return getPrebidConsent(e)&&(pbjsConfig.pubcid.enable=!0,pbjsConfig.consentManagement.allowAuctionWithoutConsent=!0),!hasCmp()&&hasLegacyConsent()&&(pbjsConfig.consentManagement.allowAuctionWithoutConsent=!0),pbjsConfig}function loadPrebid(e,t,n){if(adSettings.prebid&&getPrebidConsent(n)){var o=getAdunits(e,t),i=getPbjsConfig(n);pbjs.que.push(function(){pbjs.setConfig(i),pbjs.addAdUnits(o),pbjs.requestBids({bidsBackHandler:r})})}function r(){if(adSettings.prebid){if(pbjs.initAdserverSet)return;pbjs.initAdserverSet=!0,googletag.cmd.push(function(){pbjs.que.push(function(){pbjs.setTargetingForGPTAsync(),googletag.pubads().refresh()})})}else{if(pbjs.initAdserverSet)return;pbjs.initAdserverSet=!0,googletag.cmd.push(function(){googletag.pubads().refresh()})}}PREBID_TIMEOUT=1500,adSettings.PREBID_TIMEOUT&&(PREBID_TIMEOUT=adSettings.PREBID_TIMEOUT),setTimeout(function(){r()},PREBID_TIMEOUT)}function getAdslots(){var e=adSettings.adslots[getSection()],t={},n=window.innerWidth;for(adslot in e){viewports=e[adslot].viewports;for(var o=0;o<viewports.length;o++)viewport=viewports[o],minwidth=viewport.minwidth,maxwidth=viewport.maxwidth,!maxwidth&&minwidth&&minwidth<=n?t[adslot]=viewport.sizes:maxwidth&&!minwidth&&maxwidth>=n?t[adslot]=viewport.sizes:maxwidth&&minwidth&&maxwidth>=n&&minwidth<n?t[adslot]=viewport.sizes:maxwidth||minwidth||(t[adslot]=viewport.sizes)}return t}function getTargeting(e){var t={};try{keywordsRaw=document.querySelector('meta[name="keywords"]').getAttribute("content").split(","),keywords=[];for(var n=0;n<keywordsRaw.length;n++)keywords.push(cleanChars(keywordsRaw[n],!1));t.keyword=keywords}catch(e){t.keyword=[]}try{t.category=e}catch(e){}try{var o=window.location.pathname,i=o.split("/");cleanPath=cleanChars(o,!0),cleanPath&&(t.urlPath=cleanPath)}catch(e){}try{urlCat0=cleanChars(i[1],!0),urlCat0&&(t.urlCategory1=urlCat0)}catch(e){t.urlCategory1=""}try{urlCat1=cleanChars(i[2],!0),urlCat1&&(t.urlCategory2=urlCat1)}catch(e){t.urlCategory2=""}return t}function loadDfp(e){var t=document.createElement("script");t.async=!0,t.type="text/javascript";var n="https:"==document.location.protocol;t.src=(n?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o),e()}function loadPrebidJs(e){var t=document.createElement("script");t.async=!0,t.type="text/javascript";var n="https:"==document.location.protocol;t.src=(n?"https:":"http:")+"//crs-media-cdn.nl/prebid.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o),e()}function defineAdslots(e,t,n){googletag.cmd.push(function(){for(adslot in e){var n="/"+adSettings.dfpNetworkcode+"/"+adSettings.siteName+"-"+adslot,o=e[adslot],i="ad-"+adslot;googletag.defineSlot(n,o,i).setTargeting("category",section).setTargeting("urlcategory1",t.urlCategory1).setTargeting("urlcategory2",t.urlCategory2).setTargeting("urlpath",t.urlPath).setTargeting("keywords",t.keyword).addService(googletag.pubads())}googletag.pubads().collapseEmptyDivs(),googletag.pubads().enableSingleRequest(),googletag.enableServices()})}function renderAds(e){for(var t in e){!function e(t,n,o){setTimeout(function(){if(!o)try{o=document.getElementById(n).parentNode;var i=document.createElement("div");i.id="ad-"+n,o.insertBefore(i,document.getElementById(i.id)),googletag.cmd.push(function(){googletag.display(i.id)})}catch(e){}--t&&e(t,n,o)},100),1!=t||o||console.log("The following div was expected by the Admanager, but doesn't exist on the site: "+n)}(10,t,!1)}gotAds=!0}function getSection(){var e=document.querySelector('meta[property="crsmediasection"]');document.querySelector('meta[property="crsmediasection"]').content,e||(e=document.querySelector('meta[property="yieldprosection"]')),e||(e=document.querySelector('meta[property="ancorasection"]')),viewport=window.innerWidth;var t=e&&e.getAttribute("content");return t||(t=Object.keys(adSettings.adslots)[0],console.log("No section found on site. Please add one")),adSettings.adslots[t]||(console.log("Error: Section not found in ad mapping. Contact AdOps. Defaulting to front page grid. Section name expected: "+t),t=Object.keys(adSettings.adslots)[0]),t}function cleanChars(e,t){try{return!0===t&&(e=e.replace(new RegExp("/","g"),"_")),(e=e.replace(/\W/g,"")).length>32&&(e=e.substring(0,32)),e}catch(e){}}function checkArray(e){return Array.isArray(e[0])?e:[e]}function getAdunits(e,t){var n=[];for(adslot in e)if(!adSettings.adslots[t][adslot].excludeRtb){var o=[],i=checkArray(e[adslot]);adSettings.hbSettings.rubicon.active&&o.push(pbRubicon()),adSettings.hbSettings.appnexus.active&&o.push(pbAppNexus());for(var r=0;r<i.length;r++)adSettings.hbSettings.criteo.active&&o.push(pbCriteo(i[r])),adSettings.hbSettings.ix.active&&o.push(pbIx(i[r])),adSettings.hbSettings.improveDigital.active&&o.push(pbImproveDigital(i[r]));pbAdunit={code:"ad-"+adslot,mediaTypes:{banner:{sizes:i}},bids:o},n.push(pbAdunit)}return n}function pbImproveDigital(e){improveDigital=adSettings.hbSettings.improveDigital,sizeString=e[0]+"x"+e[1];var t={};return improveDigital.active&&improveDigital.placementIds[sizeString]&&(t={bidder:"improvedigital",params:{placementId:improveDigital.placementIds[sizeString]}}),t}function pbCriteo(e){criteo=adSettings.hbSettings.criteo,sizeString=e[0]+"x"+e[1];var t={};return criteo.active&&criteo.zoneIds[sizeString]&&(t={bidder:"criteo",params:{zoneId:criteo.zoneIds[sizeString]}}),t}function pbRubicon(){rubicon=adSettings.hbSettings.rubicon;var e={};return rubicon.active&&(e={bidder:"rubicon",params:{accountId:rubicon.accountId,siteId:rubicon.siteId,zoneId:rubicon.zoneId}}),e}function pbAppNexus(){appnexus=adSettings.hbSettings.appnexus;var e={};return appnexus.active&&(e={bidder:"appnexus",params:{placementId:appnexus.accountId}}),e}function pbIx(e){ix=adSettings.hbSettings.ix;var t={};return ix.active&&(t={bidder:"ix",params:{siteId:ix.siteId,size:e}}),t}function getDfpConsent(e){if(e){if("faktor"==e)window.__cmp("addEventListener","cmpReady",function(){window.__cmp("getAdditionalVendorConsents",void 0,function(e){if(e.purposeConsents[1]&&e.vendorConsents[3])return!0})});else if("cookiebot"==e)return!0}else if(hasLegacyConsent())return!0}function getGoogleConsent(e){var t=!0;return e?("faktor"==e&&(t=!1,window.__cmp("getAdditionalVendorConsents",void 0,function(e){if(e.purposeConsents[2]&&e.vendorConsents[3])return!0})),!("cookiebot"==e&&!Cookiebot.consent.marketing)&&(!("cookiebot"!=e||!Cookiebot.consent.marketing)||t)):!!hasLegacyConsent()}function getPrebidConsent(e){return!e||"cookiebot"!=e||!!window.Cookiebot.marketing}function hasCmp(){return void 0!==window.__cmp?"faktor":void 0!==window.Cookiebot&&"cookiebot"}function getIabVendorConsent(e,t){var n=!0;return!!hasCmp()&&(n=!0,window.__cmp("getVendorConsents",e,function(e){for(var o=0;o<t.length;o++)e.purposeConsents[t[o]]||(n=!1)}),n)}function hasLegacyConsent(){for(var e=["cookie-agreed=2","cookieconsent_status=dismiss","cookiesAccepted=accepted","CookieMessage=True","RegioGrid=Clicked"],t=0;t<e.length;t++){if(document.cookie.indexOf(e[t])>-1)return!0}return!1}setGoogleTag(),pickAdFlow();