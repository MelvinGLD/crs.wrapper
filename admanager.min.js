var googletag=googletag||{};googletag.cmd=googletag.cmd||[];var pbjs=pbjs||{};pbjs.que=pbjs.que||[];var section=getSection(),targeting=getTargeting(section),gotAds=!1;function pickAdFlow(){hasCmp()?initCmpAds():hasLegacyConsent()&&loadAds()}function initCmpAds(){window.__cmp("addEventListener","cmpReady",function(){getDfpConsent()?loadAds():loadAdsOnConsentEvent()})}function loadAds(){loadDfp(function(){loadPrebidJs(function(){var e=getAdslots();loadPrebid(e,section),defineAdslots(e,targeting),renderAds(e)})})}function loadAdsOnConsentEvent(){gotAds||window.__cmp("addEventListener","consentChanged",function(){if(getDfpConsent()){var e="https:"==document.location.protocol,t=(e?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js",n=(e?"https:":"http:")+"//crs-media-cdn.nl/prebid.js";jQuery.getScript(t,function(){jQuery.getScript(n);var e=getAdslots();loadPrebid(e,section),defineAdslots(e,targeting),renderAds(e)})}})}function setGoogleTag(){googletag.cmd.push(function(){googletag.pubads().disableInitialLoad()}),getGoogleConsent()||googletag.cmd.push(function(){googletag.pubads().disableInitialLoad(),googletag.pubads().setRequestNonPersonalizedAds(1)})}function getPbjsConfig(){pbjsConfig={enableSendAllBids:!0,pubcid:{enable:!1,expInterval:105120},priceGranularity:"dense",consentManagement:{cmpApi:"iab",allowAuctionWithoutConsent:!1},currency:{adServerCurrency:"EUR",conversionRateFile:"https://currency.prebid.org/latest.json",bidderCurrencyDefault:{improvedigital:"EUR",criteo:"EUR",rubicon:"USD",ix:"EUR",appnexus:"EUR"}}};for(var e=!0,t=[32,91,52,10],n=0;n<t.length;n++)getIabVendorConsent(t[n],[1,2])||(e=!1);return e&&(pbjsConfig.pubcid.enable=!0),!hasCmp()&&hasLegacyConsent()&&(pbjsConfig.consentManagement.allowAuctionWithoutConsent=!0),pbjsConfig}function loadPrebid(e,t){if(adSettings.prebid){var n=getAdunits(e,t),o=getPbjsConfig();pbjs.que.push(function(){pbjs.setConfig(o),pbjs.addAdUnits(n),pbjs.requestBids({bidsBackHandler:i})})}function i(){if(adSettings.prebid){if(pbjs.initAdserverSet)return;pbjs.initAdserverSet=!0,googletag.cmd.push(function(){pbjs.que.push(function(){pbjs.setTargetingForGPTAsync(),googletag.pubads().refresh()})})}else{if(pbjs.initAdserverSet)return;pbjs.initAdserverSet=!0,googletag.cmd.push(function(){googletag.pubads().refresh()})}}PREBID_TIMEOUT=1500,adSettings.PREBID_TIMEOUT&&(PREBID_TIMEOUT=adSettings.PREBID_TIMEOUT),setTimeout(function(){i()},PREBID_TIMEOUT)}function getAdslots(){var e=adSettings.adslots[getSection()],t={},n=window.innerWidth;for(adslot in e){viewports=e[adslot].viewports;for(var o=0;o<viewports.length;o++)viewport=viewports[o],minwidth=viewport.minwidth,maxwidth=viewport.maxwidth,!maxwidth&&minwidth&&minwidth<=n?t[adslot]=viewport.sizes:maxwidth&&!minwidth&&maxwidth>=n?t[adslot]=viewport.sizes:maxwidth&&minwidth&&maxwidth>=n&&minwidth<n?t[adslot]=viewport.sizes:maxwidth||minwidth||(t[adslot]=viewport.sizes)}return t}function getTargeting(e){var t={};try{keywordsRaw=document.querySelector('meta[name="keywords"]').getAttribute("content").split(","),keywords=[];for(var n=0;n<keywordsRaw.length;n++)keywords.push(cleanChars(keywordsRaw[n],!1));t.keyword=keywords}catch(e){t.keyword=[]}try{t.category=e}catch(e){}try{var o=window.location.pathname,i=o.split("/");cleanPath=cleanChars(o,!0),cleanPath&&(t.urlPath=cleanPath)}catch(e){}try{urlCat0=cleanChars(i[1],!0),urlCat0&&(t.urlCategory1=urlCat0)}catch(e){t.urlCategory1=""}try{urlCat1=cleanChars(i[2],!0),urlCat1&&(t.urlCategory2=urlCat1)}catch(e){t.urlCategory2=""}return t}function loadDfp(e){var t=document.createElement("script");t.async=!0,t.type="text/javascript";var n="https:"==document.location.protocol;t.src=(n?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o),e()}function loadPrebidJs(e){var t=document.createElement("script");t.async=!0,t.type="text/javascript";var n="https:"==document.location.protocol;t.src=(n?"https:":"http:")+"//crs-media-cdn.nl/prebid.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o),e()}function defineAdslots(o,i){var a=[];getIabVendorConsent(52,[2,3,4,5])&&a.push("rubicon"),googletag.cmd.push(function(){for(adslot in o){var e="/"+adSettings.dfpNetworkcode+"/"+adSettings.siteName+"-"+adslot,t=o[adslot],n="ad-"+adslot;googletag.defineSlot(e,t,n).setTargeting("category",section).setTargeting("urlcategory1",i.urlCategory1).setTargeting("urlcategory2",i.urlCategory2).setTargeting("urlpath",i.urlPath).setTargeting("keywords",i.keyword).setTargeting("disallow_networks",a).addService(googletag.pubads()),googletag.pubads().collapseEmptyDivs(),googletag.pubads().enableSingleRequest(),googletag.enableServices()}})}function renderAds(e){for(var t in e){!function t(n,o,i){setTimeout(function(){if(!i)try{i=document.getElementById(o).parentNode;var e=document.createElement("div");e.id="ad-"+o,i.insertBefore(e,document.getElementById(e.id)),googletag.cmd.push(function(){googletag.display(e.id)})}catch(e){}--n&&t(n,o,i)},100),1!=n||i||console.log("The following div was expected by the Admanager, but doesn't exist on the site: "+o)}(10,t,!1)}gotAds=!0}function getSection(){var e=document.querySelector('meta[property="crsmediasection"]');document.querySelector('meta[property="crsmediasection"]').content,e||(e=document.querySelector('meta[property="yieldprosection"]')),e||(e=document.querySelector('meta[property="ancorasection"]')),viewport=window.innerWidth;var t=e&&e.getAttribute("content");return t||(t=Object.keys(adSettings.adslots)[0],console.log("No section found on site. Please add one")),adSettings.adslots[t]||(console.log("Error: Section not found in ad mapping. Contact AdOps. Defaulting to front page grid. Section name expected: "+t),t=Object.keys(adSettings.adslots)[0]),t}function cleanChars(e,t){try{return!0===t&&(e=e.replace(new RegExp("/","g"),"_")),32<(e=e.replace(/\W/g,"")).length&&(e=e.substring(0,32)),e}catch(e){}}function checkArray(e){return Array.isArray(e[0])?e:[e]}function getAdunits(e,t){var n=[];for(adslot in e)if(!adSettings.adslots[t][adslot].excludeRtb){var o=[],i=checkArray(e[adslot]);adSettings.hbSettings.rubicon.active&&o.push(pbRubicon()),adSettings.hbSettings.appnexus.active&&o.push(pbAppNexus());for(var a=0;a<i.length;a++)adSettings.hbSettings.criteo.active&&o.push(pbCriteo(i[a])),adSettings.hbSettings.ix.active&&o.push(pbIx(i[a])),adSettings.hbSettings.improveDigital.active&&o.push(pbImproveDigital(i[a]));pbAdunit={code:"ad-"+adslot,mediaTypes:{banner:{sizes:i}},bids:o},n.push(pbAdunit)}return n}function pbImproveDigital(e){improveDigital=adSettings.hbSettings.improveDigital,sizeString=e[0]+"x"+e[1];var t={};return improveDigital.active&&improveDigital.placementIds[sizeString]&&(t={bidder:"improvedigital",params:{placementId:improveDigital.placementIds[sizeString]}}),t}function pbCriteo(e){criteo=adSettings.hbSettings.criteo,sizeString=e[0]+"x"+e[1];var t={};return criteo.active&&criteo.zoneIds[sizeString]&&(t={bidder:"criteo",params:{zoneId:criteo.zoneIds[sizeString]}}),t}function pbRubicon(){rubicon=adSettings.hbSettings.rubicon;var e={};return rubicon.active&&(e={bidder:"rubicon",params:{accountId:rubicon.accountId,siteId:rubicon.siteId,zoneId:rubicon.zoneId}}),e}function pbAppNexus(){appnexus=adSettings.hbSettings.appnexus;var e={};return appnexus.active&&(e={bidder:"appnexus",params:{placementId:appnexus.accountId}}),e}function pbIx(e){ix=adSettings.hbSettings.ix;var t={};return ix.active&&(t={bidder:"ix",params:{siteId:ix.siteId,size:e}}),t}function getDfpConsent(){var t=!1;return hasCmp()?window.__cmp("addEventListener","cmpReady",function(){window.__cmp("getAdditionalVendorConsents",void 0,function(e){e.purposeConsents[1]&&e.vendorConsents[3]&&(t=!0)})}):hasLegacyConsent()&&(t=!0),t}function getGoogleConsent(){var t=!0;return hasCmp()?(t=!1,window.__cmp("getAdditionalVendorConsents",void 0,function(e){e.purposeConsents[2]&&e.vendorConsents[3]&&(t=!0)}),t):!!hasLegacyConsent()}function hasCmp(){return void 0!==window.__cmp}function getIabVendorConsent(e,n){var o=!0;return!!hasCmp()&&(o=!0,window.__cmp("getVendorConsents",e,function(e){for(var t=0;t<n.length;t++)e.purposeConsents[n[t]]||(o=!1)}),o)}function hasLegacyConsent(){for(var e=["cookie-agreed=2","cookieconsent_status=dismiss","cookiesAccepted=accepted","CookieMessage=True","RegioGrid=Clicked"],t=0;t<e.length;t++){if(-1<document.cookie.indexOf(e[t]))return!0}return!1}setGoogleTag(),pickAdFlow();